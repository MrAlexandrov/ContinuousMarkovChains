# Ключевые концепты непрерывных марковских цепей

## Уравнения Колмогорова

Уравнения Колмогорова являются фундаментальными в теории непрерывных марковских цепей и описывают эволюцию вероятностей состояний системы во времени.

### Дифференциальные уравнения Колмогорова

Дифференциальные уравнения Колмогорова описывают изменение вероятностей состояний системы во времени:

$$\frac{dp(t)}{dt} = Q^T \cdot p(t)$$

где:
- $p(t)$ - вектор вероятностей состояний системы в момент времени $t$
- $Q^T$ - транспонированная матрица интенсивностей переходов
- Начальное условие: $p(0) = [1, 0, \ldots, 0]^T$ (система начинает работу из состояния, когда все устройства исправны)

Матрица интенсивностей переходов $Q$ содержит интенсивности переходов между всеми возможными состояниями системы. Элемент $Q_{ij}$ представляет интенсивность перехода из состояния $i$ в состояние $j$.

Диагональные элементы матрицы $Q$ содержат отрицательные суммы всех интенсивностей выхода из соответствующих состояний:

$$Q_{ii} = -\sum_{j \neq i} Q_{ij}$$

### Алгебраические уравнения Колмогорова для установившегося режима

В установившемся (стационарном) режиме вероятности состояний не меняются со временем, поэтому производные равны нулю:

$$\frac{dp(t)}{dt} = 0$$

Это приводит к системе линейных алгебраических уравнений:

$$Q^T \cdot \pi = 0$$

где:
- $\pi$ - вектор стационарных вероятностей
- $0$ - вектор нулей

Дополнительно необходимо условие нормировки:

$$\sum_{i=0}^{N-1} \pi_i = 1$$

### Уравнения баланса

Для каждого состояния $i$ уравнение баланса имеет вид:

$$\sum_{j \neq i} \lambda_{ji} \cdot \pi_j = \sum_{j \neq i} \lambda_{ij} \cdot \pi_i$$

Что означает: сумма потоков вероятности, входящих в состояние $i$, равна сумме потоков вероятности, выходящих из состояния $i$.

### Решение системы уравнений

Для решения системы уравнений Колмогорова для установившегося режима используется следующий алгоритм:

1. Создается матрица $A = Q^T$
2. Последняя строка $A$ заменяется на условие нормировки (все элементы = 1)
3. Создается вектор правой части $b = [0, 0, \ldots, 1]^T$
4. Решается система $A \cdot \pi = b$ методом QR-разложения

Полученный вектор $\pi$ содержит стационарные вероятности всех состояний системы.

### Пример уравнений для конкретных состояний

Для состояния $(5, 2)$ (все устройства исправны):

$$\frac{dp_{(5,2)}(t)}{dt} = -p_{(5,2)}(t) \cdot (5\lambda_A + 2\lambda_B) + p_{(4,2)}(t) \cdot \lambda_S + p_{(5,1)}(t) \cdot \lambda_S$$

Для состояния $(4, 2)$ (одно устройство типа A неисправно):

$$\frac{dp_{(4,2)}(t)}{dt} = p_{(5,2)}(t) \cdot 5\lambda_A - p_{(4,2)}(t) \cdot (4\lambda_A + 2\lambda_B + \lambda_S) + p_{(3,2)}(t) \cdot \lambda_S + p_{(4,1)}(t) \cdot \lambda_S$$

## Правило Стёрджеса

Правило Стёрджеса (Sturges' rule) — это эмпирическое правило для определения оптимального количества интервалов (бинов) при построении гистограммы. Оно основано на предположении, что данные имеют приблизительно нормальное распределение.

### Формула правила Стёрджеса

Количество интервалов (бинов) $k$ для выборки размера $n$ определяется по формуле:

$$k = 1 + 3.322 \cdot \log_{10}(n)$$

где:
- $k$ - количество интервалов (бинов)
- $n$ - размер выборки (количество наблюдений)
- $\log_{10}$ - десятичный логарифм

### Применение правила Стёрджеса

После определения количества интервалов $k$, ширина каждого интервала $h$ вычисляется как:

$$h = \frac{x_{max} - x_{min}}{k}$$

где:
- $x_{max}$ - максимальное значение в выборке
- $x_{min}$ - минимальное значение в выборке

### Пример реализации в коде

```cpp
// Определяем количество бинов по правилу Стёрджеса
int numBins = 1 + 3.322 * log10(data.size());

// Находим минимальное и максимальное значения
double minVal = *std::min_element(data.begin(), data.end());
double maxVal = *std::max_element(data.begin(), data.end());

// Вычисляем ширину бина
double binWidth = (maxVal - minVal) / numBins;
```

### Ограничения правила Стёрджеса

1. Правило Стёрджеса может давать слишком мало бинов для больших выборок (n > 200).
2. Оно предполагает, что данные имеют приблизительно нормальное распределение.
3. Для сильно асимметричных распределений или распределений с тяжелыми хвостами могут потребоваться другие методы определения количества бинов.

### Альтернативные методы определения количества бинов

1. **Правило Скотта**: $h = 3.5 \cdot \sigma \cdot n^{-1/3}$, где $\sigma$ - стандартное отклонение выборки.
2. **Правило Фридмана-Диакониса**: $h = 2 \cdot IQR \cdot n^{-1/3}$, где $IQR$ - межквартильный размах.
3. **Правило квадратного корня**: $k = \sqrt{n}$.

## Характеристики системы на основе стационарных вероятностей

На основе стационарных вероятностей состояний можно вычислить следующие характеристики системы:

### Вероятность отказа системы

Вероятность отказа системы равна сумме вероятностей состояний, в которых система не функционирует:

$$P_{failure} = \sum_{a < 1 \text{ или } b < N_B} \pi_{(a,b,r)}$$

### Среднее число готовых устройств

Среднее число готовых устройств типа A:

$$\bar{A} = \sum_{a,b,r} a \cdot \pi_{(a,b,r)}$$

Среднее число готовых устройств типа B:

$$\bar{B} = \sum_{a,b,r} b \cdot \pi_{(a,b,r)}$$

### Коэффициент загрузки ремонтной службы

Коэффициент загрузки ремонтной службы равен сумме вероятностей состояний, в которых происходит ремонт:

$$K_{repair} = \sum_{r > 0} \pi_{(a,b,r)}$$